(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[789],{9249:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/battle/[battleId]",function(){return a(8391)}])},7418:function(e,t,a){"use strict";a.d(t,{E:function(){return f}});var n=a(2322),r=a(2784),s=a(9097),i=a.n(s),l=a(1453),o=a(2367),c=function(e){var t=e.imageUrl,a=e.actionLink,r=e.timeStamp,s=e.children,i=(0,n.jsx)("svg",{style:{width:"30px",height:"30px"},viewBox:"0 0 24 24",children:(0,n.jsx)("path",{fill:"currentColor",d:"M12 19.2c-2.5 0-4.71-1.28-6-3.2.03-2 4-3.1 6-3.1s5.97 1.1 6 3.1a7.232 7.232 0 0 1-6 3.2M12 5a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3m0-3A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10c0-5.53-4.5-10-10-10z"})});return(0,n.jsxs)("div",{className:"notification-item",children:[(0,n.jsxs)("div",{className:"notification-item__content",children:[(0,n.jsx)("div",{className:"notification-item__image",children:t?(0,n.jsx)("img",{src:t,alt:""}):i}),(0,n.jsxs)("div",{className:"notification-item__text",children:[s,(0,n.jsxs)("div",{className:"notification-item__time",children:[(0,o.VG)(r)," ago"]})]})]}),a?(0,n.jsx)("a",{href:a,className:"shadow-link"}):null]})},d=a(7037),u=a(4136),h=a.n(u),m=a(9241);function f(e){var t=e.battleId,a=(0,r.useState)(!1),s=a[0],o=a[1],u=(0,r.useState)([]),f=u[0],p=u[1];return(0,r.useEffect)((function(){o(!0),(0,d.V6)(t).then((function(e){o(!1),p(e)}))}),[t]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.M,{children:"Activity Timeline"}),(0,n.jsx)("div",{className:"item__content item__content--no-padding",children:(0,n.jsxs)("div",{className:h().streams,children:[s?(0,n.jsx)("p",{className:"para ta-c",style:{margin:"1rem 0"},children:(0,n.jsx)(m.a,{})}):null,s||f.length?null:(0,n.jsx)("p",{className:"para ta-c",children:"No activity recorded here."}),!s&&f.map((function(e){return(0,n.jsxs)(c,{timeStamp:e.timestamp,imageUrl:e.playerProfile.avatar,children:[e.playerProfile.displayName," ",e.data.userId===e.data.previousUserId?"broke own record on":"set a new record on"," ",(0,n.jsx)(i(),{href:"/play/".concat(e.data.levelId),children:(0,n.jsxs)("a",{className:"link",children:["Target #",e.data.levelId]})})," ","with ",e.data.codeSize," chars (",e.data.codeSize-e.data.previousUserCodeSize,")."]},e.id)}))]})})]})}},419:function(e,t,a){"use strict";a.d(t,{a:function(){return o}});var n=a(2322),r=a(7500),s=a(2259),i=a.n(s),l=a(5598);function o(e){var t=e.gameMode;return(0,n.jsx)("div",{className:i().battleMode,children:t===r.BattleGameModes.FIRST_TO_MATCH?(0,n.jsxs)(l.HStack,{children:[(0,n.jsx)("p",{className:i().gameModeLabel,children:"\u23f0 Time Attack"}),(0,n.jsx)("p",{children:"Quickest to get 100% matches wins the game"})]}):(0,n.jsxs)(l.HStack,{children:[(0,n.jsx)("p",{className:i().gameModeLabel,children:"\u26f3 Code Golf"}),(0,n.jsx)("p",{children:"Shortest code with a 100% match gets the highest score"})]})})}},2220:function(e,t,a){"use strict";a.d(t,{z:function(){return o}});var n=a(865),r=a(6670),s=a(6297),i=a(2322),l=(a(2784),a(9241));function o(e){var t=e.type,a=void 0===t?"button":t,o=e.primary,c=e.danger,d=e.success,u=e.cool,h=e.size,m=e.extraClasses,f=void 0===m?"":m,p=e.children,g=e.isLoading,x=(0,s.Z)(e,["type","primary","danger","success","cool","size","extraClasses","children","isLoading"]);return(0,i.jsxs)("button",(0,r.Z)((0,n.Z)({type:a,className:"button ".concat(o?"button--primary":""," \n      ").concat(u?"button--cssbattle":"","\n      ").concat(h?"button--".concat(h):"","\n      ").concat(d?"button--success":""," ").concat(c?"button--danger":""," ").concat(f),disabled:g},x),{children:[p,(0,i.jsx)("div",{style:{display:"flex",transition:"max-width 0.3s ease",overflow:"hidden",maxWidth:g?"1.6em":0},children:(0,i.jsx)(l.a,{height:"1.3em",leftMargin:"0.5rem"})})]}))}},1942:function(e,t,a){"use strict";a.d(t,{N:function(){return r}});var n=a(2322);function r(){return(0,n.jsxs)("div",{className:"friends-empty",children:[(0,n.jsx)("img",{alt:"Two friends high fiving",src:"/images/friends.svg"}),(0,n.jsx)("p",{className:"friends-empty__title",children:"Add friends!"}),(0,n.jsx)("p",{className:"friends-empty__desc",children:"Want to see where you stand only among your friends? Visit their profile and add them as friends to see them here!"})]})}},8742:function(e,t,a){"use strict";a.d(t,{P:function(){return o}});var n=a(2322),r=(a(2784),a(2367)),s=a(1251),i=a(7424),l=a(5598);function o(e){var t,a,o,c,d,u=e.data,h=e.showTimeTaken;return(0,n.jsxs)("div",{className:"leaderboard__user  leaderboard__user--".concat(u.rank),children:[(0,n.jsx)(s.qE,{small:!0,size:"32",url:u.playerProfile.avatar,username:u.playerProfile.username,userId:u.userId||u.playerProfile.id||u.playerProfile.uid,className:"leaderboard__user-avatar"}),(0,n.jsxs)("div",{className:"leaderboard__user-info",children:[(0,n.jsx)(s.Rj,{name:u.playerProfile.displayName,username:u.playerProfile.username,isPro:u.playerProfile.isPro,userId:u.userId||u.playerProfile.id||u.playerProfile.uid,className:"leaderboard__user-name",ellipsis:!0}),(0,n.jsxs)(l.HStack,{align:"center",children:[(0,n.jsxs)("p",{className:"leaderboard__user-score",children:[h?null:u.score?u.score.toFixed(2):"0"," ",h&&u.playedCount?"(".concat(u.playedCount," Target").concat(u.playedCount>1?"s":"",")"):""," ",h?u.timeTaken?"".concat(null===(t=u.timeTaken)||void 0===t?void 0:t.toFixed(2)," secs"):"-":null," ",!h&&u.playedCount?"(".concat(u.playedCount," Target").concat(u.playedCount>1?"s":"",")"):"",u.codeSize?"(".concat(u.codeSize," Chars)"):""]}),(0,n.jsx)(i.c,{tags:(null===(a=u.lastUpdated)||void 0===a?void 0:a.seconds)===(null===(o=u.nonCss)||void 0===o||null===(c=o.lastUpdated)||void 0===c?void 0:c.seconds)?null===(d=u.nonCss)||void 0===d?void 0:d.tags:[]})]})]}),(0,n.jsx)("p",{className:"leaderboard__user-rank  leaderboard__user-rank--".concat(u.rank),children:(0,r.x4)(u.rank)})]})}},94:function(e,t,a){"use strict";a.d(t,{g:function(){return s}});var n=a(2322),r=a(3290);function s(e){var t=e.isFriendsMode,a=e.onChange,s=function(e){a(e),(0,r.q)({name:"friendLeaderboardToggle",label:"friends"===e.target.value})};return(0,n.jsxs)("div",{className:"filter leaderboard-filter",children:[(0,n.jsxs)("span",{className:"filter__button",children:[(0,n.jsx)("input",{type:"radio",name:"leaderboard-filter",id:"friends",value:"friends",defaultChecked:t,onChange:s}),(0,n.jsx)("label",{htmlFor:"friends",children:"Friends Only"})]}),(0,n.jsxs)("span",{className:"filter__button",children:[(0,n.jsx)("input",{type:"radio",name:"leaderboard-filter",id:"everyone",value:"everyone",defaultChecked:!t,onChange:s}),(0,n.jsx)("label",{htmlFor:"everyone",children:"All Players"})]})]})}},8432:function(e,t,a){"use strict";var n=a(2322),r=a(8724),s=a(4030);t.Z=function(e){var t=e.alignMenuRight,a=e.isCSSLeaderboard,i=e.setIsCSSLeaderboard,l=e.levelId,o=e.battleId;return(0,s.isNonCssAvailable)({levelId:l,battleId:o})?(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(r.L,{alignRight:t,isFixed:!0,dropdownBtnClasses:"dropdown-btn--small  dropdown-btn--leaderboard-switch ".concat(a?"":"dropdown-btn--primary"),dropdownMenuClasses:"dropdown-menu--no-padding dropdown-menu--small",dropdownBtnContent:a?"CSS":"ALL",children:(0,n.jsxs)("div",{style:{minWidth:"22rem"},children:[(0,n.jsxs)("div",{className:"dropdown-selector",onClick:function(){return i(!0)},children:[(0,n.jsx)("span",{className:"small-pill",children:"CSS"}),(0,n.jsx)("p",{children:"Leaderboard only includes pure CSS solutions. Great for beginners"})]}),(0,n.jsxs)("div",{className:"dropdown-selector",onClick:function(){return i(!1)},children:[(0,n.jsx)("span",{className:"small-pill small-pill--primary",children:"ALL"}),(0,n.jsx)("p",{children:"Leaderboard includes all solutions (SVG-in-CSS, Unicode, and CSS). Great for advanced players"})]})]})})}):null}},1453:function(e,t,a){"use strict";a.d(t,{M:function(){return r}});var n=a(2322);a(2784);function r(e){var t=e.children,a=e.sticky,r=e.keyCombo,s=e.extraContent,i=e.meta;return(0,n.jsxs)("div",{className:"item__header  ".concat(a?"item__header--sticky":""),children:[(0,n.jsx)("h3",{className:"header__title",children:t}),s,r&&(0,n.jsxs)("p",{className:"key-combo key-combo--header",children:[" ",r," "]}),(0,n.jsx)("div",{className:"header__extra-info",children:i})]})}},7424:function(e,t,a){"use strict";a.d(t,{c:function(){return s}});var n=a(2322),r=a(2784),s=function(e){var t=e.tags,a=(0,r.useState)([]),s=a[0],i=a[1],l="nonCss";return(0,r.useEffect)((function(){t&&(t.indexOf(l)>-1&&i(t.filter((function(e){return e!==l}))))}),[t]),(0,n.jsx)("div",{children:s.map((function(e,t){return(0,n.jsx)("span",{className:"small-pill small-pill--primary",children:e},t)}))})}},6368:function(e,t,a){"use strict";a.d(t,{A:function(){return o}});var n=a(8788),r=a(4776),s=a.n(r),i=a(2784),l=a(7037),o=function(e){var t=e.battleId,a=e.level,r=(0,i.useState)(),o=r[0],c=r[1];return(0,i.useEffect)((function(){if(t||a){var e=function(){var e=(0,n.Z)(s().mark((function e(){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return e.next=3,(0,l.ch)(t);case 3:e.t0=e.sent,e.next=9;break;case 6:return e.next=8,(0,l.Ws)(a);case 8:e.t0=e.sent;case 9:n=e.t0,c(n);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}}),[t,a]),o}},9411:function(e,t,a){"use strict";a.d(t,{L:function(){return i}});var n=a(6383),r=a(4030),s=a(9318);function i(e){var t=e.levelId,a=e.battleId,i=(0,n.Z)((0,s._)("showCSSLeaderboard",!0),2),l=i[0],o=i[1];return(0,r.isNonCssAvailable)({levelId:t,battleId:a})?[l,o]:[!0,function(){}]}},9318:function(e,t,a){"use strict";a.d(t,{_:function(){return s}});var n=a(2838),r=a(2784);function s(e,t){var a=(0,r.useState)((function(){try{var a=window.localStorage.getItem(e);return a?JSON.parse(a):t}catch(n){return console.log(n),t}})),s=a[0],i=a[1];return[s,function(t){try{var a=(0,n.Z)(t,Function)?t(s):t;i(a),window.localStorage.setItem(e,JSON.stringify(a))}catch(r){console.log(r)}}]}},8391:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Q}});var n=a(2322),r=a(2784),s=a(5632),i=a(7729),l=a.n(i),o=a(7500),c=a(4697),d=a(7171),u=a(865),h=a(6670),m=a(6383),f=a(930),p=a(1453),g=a(7037),x=a(8742),v=a(3552),j=a(9241),b=a(9318),_=a(94),y=a(1942),N=a(9097),S=a.n(N),w=a(8432),C=a(9411),k=a(6368),I=a(2367),B=function(e){var t=e.title,a=e.battleId,s=e.numOfPlayersToShow,i=void 0===s?10:s,l=(0,r.useContext)(v.S),c=(0,r.useState)([]),d=c[0],N=c[1],B=(0,r.useState)({}),T=B[0],M=B[1],L=(0,r.useState)(),P=L[0],F=L[1],O=(0,m.Z)((0,b._)("showFriendsLeaderboard",!!l),2),E=O[0],D=O[1],H=(0,m.Z)((0,C.L)({battleId:a}),2),A=H[0],G=H[1],z=(0,o.checkIfCustomBattle)({id:a}),Z=(0,k.A)({battleId:a}),U=(0,r.useState)({battlePlayerCount:{}}),R=U[0],W=U[1];return(0,r.useEffect)((function(){(0,g.pc)().then(W)}),[]),(0,r.useEffect)((function(){Z&&(F(!0),N([]),M({}),(E&&l?(0,g.eL)({battleId:a,userId:l.uid,isCSSLeaderboard:A}):(0,g.uL)({battleId:a,numberOfPlayers:i,isCSSLeaderboard:A})).then((function(e){A||e.map((function(e){var t,a;e.score=null===(t=e.overall)||void 0===t?void 0:t.score,e.lastUpdated=null===(a=e.overall)||void 0===a?void 0:a.lastUpdated})),N(e),F(!1),l&&e.length&&(e.find((function(e){return e.id===l.uid}))?M({rank:e.findIndex((function(e){return e.id===l.uid}))+1}):(0,g.r8)({userId:l.uid,battleId:a}).then((function(t){M(t),N((0,f.Z)(e).concat([{score:t.score,playerProfile:(0,h.Z)((0,u.Z)({},l),{avatar:l.photoURL}),id:l.uid,rank:t.rank,playedCount:t.playedCount,timeTaken:(0,I.Xg)(Z,t.lastUpdated)}]))})).catch((function(e){console.log("failed to fetch rank",e)})))})))}),[l?l.uid:"",a,Z,E,A]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.M,{extraContent:(0,n.jsx)(w.Z,{battleId:a,alignMenuRight:!0,isCSSLeaderboard:A,setIsCSSLeaderboard:G}),meta:"You: ".concat(T.rank||"-","/").concat(E?d.length:R.battlePlayerCount[a]||"-"),children:t}),(0,n.jsxs)("div",{className:"item__content",children:[l&&(0,n.jsx)(_.g,{isFriendsMode:E,onChange:function(e){D("friends"===e.target.value)}}),E&&!P&&!d.length&&(0,n.jsx)(y.N,{}),0===T.rank&&(0,n.jsx)("p",{className:"section-helper section-helper--no-score",children:"Play at least 1 target to see your rank."}),(0,n.jsxs)("div",{className:"leaderboard-container",children:[P?(0,n.jsx)("p",{className:"ta-c",children:(0,n.jsx)(j.a,{})}):null,!P&&!d.length&&!E&&(0,n.jsx)("p",{className:"para",children:"No one here. It could be you! How about playing some targets?"}),(0,n.jsx)("ol",{className:"leaderboard__user-list",children:d.map((function(e,t){return(0,n.jsx)("li",{children:(0,n.jsx)(x.P,{data:(0,h.Z)((0,u.Z)({},e),{rank:void 0===e.rank?t+1:e.rank}),showTimeTaken:Z.gameMode===o.BattleGameModes.FIRST_TO_MATCH},t)},t)}))})]}),d.length?(0,n.jsxs)("p",{className:"para ta-c leaderboard-buttons",children:[(0,n.jsx)(S(),{href:"/leaderboard/battle/".concat(a),children:(0,n.jsx)("a",{className:"button",children:"See top 100"})}),!z&&(0,n.jsx)(S(),{href:"/leaderboard",children:(0,n.jsx)("a",{className:"button",style:{marginLeft:"1rem"},children:"All-time leaderboard"})})]}):null]})]})},T=a(1251),M=a(1551),L=a(4030);function P(e){var t,a=e.data,s=e.playerData,i=void 0===s?{}:s,l=e.stats,o=e.unlockDate,c=e.gameMode,d=(0,r.useContext)(v.S),u=(0,r.useState)(!a.id),h=u[0],m=u[1];a.image=h?a.isOpen?"/targets/0-open.png":"/targets/0.png?v=2":a.image;var f=null===(t=a.image)||void 0===t?void 0:t.replace(/\.png/,"@2x.png");return(0,r.useEffect)((function(){m(!a.id)}),[a.id]),(0,n.jsxs)("div",{className:"target-tile ".concat(a.id?"":"target-tile--dummy"," ").concat(a.isOpen?"target-tile--public":""),children:[a.id&&(0,n.jsx)(S(),{href:"/play/".concat(a.id),children:(0,n.jsx)("a",{className:"shadow-link",title:"Play target number ".concat(a.id)})}),(0,n.jsx)("img",{src:a.image,srcSet:"".concat(f," 2x"),alt:"",loading:"lazy",className:"target-tile__image"}),(0,n.jsxs)("div",{className:"target-tile__info",children:[(0,n.jsxs)("div",{className:"target-top-info",children:[a.id?(0,n.jsx)("p",{className:"target-top-info__pill",children:a.id.length>5&&a.name||"#".concat(a.id)}):null,a.isOpen?(0,n.jsx)("p",{className:"target-top-info__pill",children:(0,n.jsx)("img",{alt:"",src:"/images/open-book.svg"})}):null]}),(0,n.jsxs)("div",{className:"target-highscore",children:[l&&"firstToMatch"!==c?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"target-highscore__right",children:[(0,n.jsx)("div",{className:"target-highscore__username",children:(0,n.jsx)(T.Rj,{name:l.highscore.playerProfile.displayName,username:l.highscore.playerProfile.username,userId:l.highscore.playerProfile.userId,isPro:l.highscore.playerProfile.isPro,ellipsis:!0})}),(0,n.jsxs)("p",{className:"target-highscore__score",children:[l.highscore.score," ","firstToMatch"!==c?(0,n.jsxs)("span",{children:["{",l.highscore.codeSize,"}"]}):null]})]}),(0,n.jsx)(T.qE,{small:!0,size:"40",url:l.highscore.playerProfile.avatar,userId:l.highscore.playerProfile.userId,username:l.highscore.playerProfile.username,className:"target-highscore__avatar"})]}):null,l||h?null:"No highscore available",h&&o?(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"target-highscore__right",children:[(0,n.jsx)("div",{className:"target-highscore__username",children:"Unlocks in:"}),(0,n.jsx)("div",{className:"target-highscore__score",children:(0,n.jsx)(M.W,{date:o,suffix:"",prefix:"",maxLength:2})})]})}):null]}),d&&!h&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"target-tile-header",children:"Your Stats"}),(0,n.jsx)("div",{className:"target-attempts",children:(0,n.jsxs)("p",{className:"target-attempts__item target-attempts__item--score",children:["Score:",(0,n.jsxs)("span",{children:[i.score||"N/A"," ","firstToMatch"!==c?(0,n.jsxs)("span",{children:["{",i.codeSize||"-","}"]}):null]})]})})]})]}),a.isOpen?(0,n.jsx)("div",{className:"public-target-message",children:(0,n.jsxs)("p",{children:['This is an "Open" Target. Open Targets have all the top solutions public.'," ",(0,n.jsx)("a",{className:"link",href:"/blog/introducing-open-targets/",children:"Learn More"})]})}):null]})}function F(e){var t=(0,r.useState)(),a=t[0],s=t[1],i=(0,r.useState)(),l=i[0],c=i[1],d=e.gameMode;return(0,r.useEffect)((function(){if(s(),c(),e.data.id){var t=e.data.id;return(0,g.GT)(e.data.id).then((function(a){t===e.data.id&&s(a)})),function(){t=null}}}),[e.data.id]),(0,r.useEffect)((function(){var t=d=o.BattleGameModes.FIRST_TO_MATCH?0:Math.floor(e.index/2),a=(0,L.normalizeDate)(e.battleStartDate);a.setDate(a.getDate()+7*t),c(a)}),[e.data.id]),(0,n.jsx)(P,(0,h.Z)((0,u.Z)({},e),{stats:a,unlockDate:l,gameMode:d}))}var O="all",E="played",D="notPlayed";function H(e){var t=e.battle,a=function(e){y(e.target.value)},s=(0,r.useContext)(v.S),i=(0,r.useState)([]),l=i[0],o=i[1],c=(0,r.useState)(),d=c[0],m=c[1],f=(0,r.useState)(0),x=f[0],j=f[1],b=(0,r.useState)(O),_=b[0],y=b[1];return(0,r.useEffect)((function(){(0,g.TU)(t.levelIds).then(o)}),[t.id]),(0,r.useEffect)((function(){j(0),m(),s&&(0,g.HC)({userId:s.uid,levelIds:t.levelIds}).then((function(e){j(Object.keys(e).length),m(e)}))}),[s?s.uid:"",t.id]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.M,{sticky:!0,meta:s?(0,n.jsx)("div",{children:(0,n.jsxs)("span",{className:"filter",children:[(0,n.jsxs)("span",{className:"filter__button",children:[(0,n.jsx)("input",{defaultChecked:!0,type:"radio",name:"filter",id:"all",value:O,onChange:a}),(0,n.jsxs)("label",{htmlFor:"all",children:["All (","".concat(t.levelIds.length),")"]})]}),(0,n.jsxs)("span",{className:"filter__button",children:[(0,n.jsx)("input",{type:"radio",name:"filter",id:"played",value:E,onChange:a}),(0,n.jsxs)("label",{htmlFor:"played",children:["Played (","".concat(x),")"]})]}),(0,n.jsxs)("span",{className:"filter__button",children:[(0,n.jsx)("input",{type:"radio",name:"filter",id:"notPlayed",value:D,onChange:a}),(0,n.jsxs)("label",{htmlFor:"notPlayed",children:["Not yet played (","".concat(l.length-x),")"]})]})]})}):null,children:"Targets"}),(0,n.jsx)("div",{className:"item__content",children:(0,n.jsx)("div",{className:"targets-container",children:l.map((function(e,a){return _===O||_===E&&d[e.id]||_===D&&!d[e.id]?(0,n.jsx)(F,{data:(0,h.Z)((0,u.Z)({},e),{id:e.id,isOpen:!(!t.openLevelIds||!t.openLevelIds.includes(e.id||t.firstLevelId+a))}),playerData:d?d[e.id]:void 0,index:a,totalLevels:l.length,battleStartDate:t.startDate,gameMode:t.gameMode},a):null}))})})]})}var A=a(8788),G=a(4776),z=a.n(G),Z=a(3029),U=a(1893),R=a(3290),W=a(2220),q=a(419);function Y(e){return e.endDate||+new Date(1e3*e.startDate.seconds)+60*e.duration*1e3}function V(e){var t=e.battle,a=function(){return i&&(!i.settings||!i.settings.emailNotifications)&&!1!==d},i=(0,U.a)(),l=(0,s.useRouter)(),c=(0,r.useState)(),d=c[0],u=c[1],h=(0,o.checkIfCustomBattle)(t),m=(0,r.useState)((0,o.getBattleStatus)(t)),f=m[0],x=m[1],v=(0,r.useState)(!1),j=v[0],b=v[1];function _(e){return y.apply(this,arguments)}function y(){return(y=(0,A.Z)(z().mark((function e(a){var n;return z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i){e.next=6;break}return e.next=3,i.getIdToken();case 3:e.t0=e.sent,e.next=7;break;case 6:e.t0="";case 7:if(n=e.t0){e.next=10;break}return e.abrupt("return");case 10:return b(!0),e.abrupt("return",fetch("".concat(g.bl,"/").concat(a===o.BattleStatuses.ONGOING?"startBattle":"stopBattle","?token=").concat(n,"&battleId=").concat(t.id)).then((function(e){return b(!1),e})));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(){return N=(0,A.Z)(z().mark((function e(){return z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i){e.next=2;break}return e.abrupt("return");case 2:if(t.levelIds.length){e.next=4;break}return e.abrupt("return",window.alert("You have not added any targets yet. Add at least 1 target to before starting the battle."));case 4:if(window.confirm("You cannot edit or restart a battle once it is started. Are you sure you want to start this battle?")){e.next=7;break}return e.abrupt("return");case 7:_(o.BattleStatuses.ONGOING).then(function(){var e=(0,A.Z)(z().mark((function e(t){var a;return z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(200!==t.status){e.next=4;break}return(0,I.lC)(3),x(o.BattleStatuses.ONGOING),e.abrupt("return");case 4:return e.next=6,t.json();case 6:if("insufficientCredits"!==(a=e.sent).error){e.next=13;break}return window.confirm("You have insufficient credits to start this custom battle. Click OK to proceed to buying credits.")&&l.push("/settings?tab=custom-battle-credits"),e.abrupt("return");case 13:if("noTargetsFound"!==a.error){e.next=16;break}return window.alert("You have not added any targets yet. Add at least 1 target to before starting the battle."),e.abrupt("return");case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){b(!1),alert("Battle could not be started. Try one more time, otherwise DM us on twitter: @css_battle")}));case 8:case"end":return e.stop()}}),e)}))),N.apply(this,arguments)}return r.useEffect((function(){x((0,o.getBattleStatus)(t))}),[t]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(p.M,{children:[t.type?t.type===o.BattleTypes.BIG_BATTLE?"Big":"Mini":"Custom"," ","Battle ",(0,n.jsx)(T.bN,{id:t.id})," - ",t.name]}),(0,n.jsxs)("div",{className:"homepage-banner",children:[(0,n.jsxs)("div",{className:"d-if",style:{alignItems:"center",marginBottom:"0.25rem"},children:[(0,n.jsxs)("h1",{className:"homepage-banner__heading",style:{marginBottom:"0",marginRight:"1rem"},children:[!h&&(0,n.jsxs)(n.Fragment,{children:["Battle ",(0,n.jsx)(T.bN,{id:t.id})," -"," "]})," ",t.name]}),(0,n.jsx)(Z.k,{status:f})]}),(0,n.jsx)("div",{style:{marginBottom:"1rem"},children:(0,n.jsx)(q.a,{gameMode:t.gameMode})}),(0,n.jsxs)("div",{className:"homepage-banner__description battle-banner__description",children:[t.description?(0,n.jsxs)("p",{className:"para",children:[t.description," ",t.sponsor?(0,n.jsxs)(n.Fragment,{children:["Sponsored by"," ",(0,n.jsx)("a",{className:"link",href:t.sponsor.link,children:t.sponsor.name}),".",t.rewards?" The following rewards will be given to players at the end of the Battle.":null]}):null]}):null,t.rewards?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"battle-rewards",children:[t.rewards.gold?(0,n.jsx)("div",{className:"reward-tile reward-tile--gold",children:t.rewards.gold}):null,t.rewards.silver?(0,n.jsx)("div",{className:"reward-tile reward-tile--silver",children:t.rewards.silver}):null,t.rewards.bronze?(0,n.jsx)("div",{className:"reward-tile reward-tile--bronze",children:t.rewards.bronze}):null,t.rewards.others?(0,n.jsx)("div",{className:"reward-tile reward-tile--regular",children:t.rewards.others}):null]}),(0,n.jsx)("p",{style:{fontSize:"12px",marginTop:"-30px"},children:t.rewards.note})]}):null]}),f===o.BattleStatuses.UPCOMING&&t.startDate?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(T.xu,{style:{padding:"0.6rem 1.5rem"},children:(0,n.jsx)(M.W,{date:(0,L.normalizeDate)(t.startDate),onFinish:function(){window.location.reload()}})}),(0,n.jsxs)("p",{className:"para",children:["Starting on ",(0,L.normalizeDate)(t.startDate).toLocaleString()]})]}):null,f===o.BattleStatuses.FINISHED&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"para",style:{marginLeft:"2rem",marginRight:"2rem"},children:h?"This Battle has finished. But you can always play the targets below. Note: Custom battle targets don't  contribute to your global ranking.":"This Battle has finished. But you can always play the targets below and improve your global ranking!"}),a()&&(0,n.jsx)(W.z,{primary:!0,onClick:function(){u(!0),(0,R.q)({name:"emailNotificationUpdated",label:1}),(0,g.Ii)(i.uid,{"settings.emailNotifications":!0}).then((function(){u(!1)}))},isLoading:d,children:"Get Notified via Email about new Battles"}),!1===d?(0,n.jsx)("p",{className:"para",children:"Great! We'll notify you about coming Battles."}):null,a()&&(0,n.jsx)("p",{className:"small",style:{margin:"2rem 2rem 0",color:"var(--clr-text-light)"},children:"With this, you'll also receive future emails from us regarding such announcements. We won't spam you :)"})]}),f===o.BattleStatuses.ONGOING&&t.startDate?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("p",{className:"para",children:["Battle ends on ",new Date(Y(t)).toLocaleString()]}),(0,n.jsx)(T.xu,{style:{padding:"0.6rem 1.5rem"},children:(0,n.jsx)(M.W,{date:Y(t),onFinish:function(){x((0,o.getBattleStatus)(t))}})})]}):null,!i&&(0,n.jsx)("p",{children:(0,n.jsx)("a",{className:"button",href:"/login",children:"Sign In / Sign Up"})}),i&&i.uid===t.createdBy?(0,n.jsxs)(T.hE,{center:!0,children:[f===o.BattleStatuses.UPCOMING?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(W.z,{primary:!0,onClick:function(){return N.apply(this,arguments)},isLoading:j,children:"Start Battle"}),(0,n.jsx)("a",{className:"link",href:"/battle/create/".concat(t.id),children:"Edit"})]}):null,f===o.BattleStatuses.ONGOING?(0,n.jsx)(W.z,{danger:!0,onClick:function(){window.confirm("You cannot restart a battle once it is stopped. Are you sure you want to stop this battle?")&&_(o.BattleStatuses.FINISHED).then(function(){var e=(0,A.Z)(z().mark((function e(t){return z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(200!==t.status){e.next=3;break}return x(o.BattleStatuses.FINISHED),e.abrupt("return");case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){b(!1),alert("Battle could not be stopped. Try one more time, otherwise DM us on twitter: @css_battle")}))},isLoading:j,children:"Stop Battle"}):null]}):null]})]})}var J=a(7418),X=a(3781),K=a.n(X),Q=function(){var e=(0,s.useRouter)(),t=(0,r.useContext)(v.S),a=(0,r.useState)(!1),i=(a[0],a[1]),u=(0,r.useState)(),h=u[0],m=u[1];(0,r.useEffect)((function(){if(e.isReady){var t=e.query.battleId,a=(0,I.NR)(t);i(a),m(a?t:parseInt(t,10))}}),[e.isReady,e.query.battleId]);var f=(0,r.useState)(),p=f[0],x=f[1];return(0,r.useEffect)((function(){h&&(0,g.ch)(h).then((function(e){(0,o.getBattleStatus)(e)!==o.BattleStatuses.UPCOMING||t&&e.createdBy===t.uid||(e.levelIds=e.levelIds.map((function(){return 0}))),x(e)}))}),[h]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l(),{children:p?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("meta",{property:"og:title",content:"Battle #".concat(p.id,": ").concat(p.name," - CSSBattle")},"ogTitle"),(0,n.jsx)("title",{children:"Battle #".concat(p.id,": ").concat(p.name," - CSSBattle")},"title")]}):null}),(0,n.jsx)(c.h,{battleId:h,battleName:p?p.name:""}),p?(0,n.jsxs)("div",{className:"container",children:[(0,n.jsxs)("div",{className:"container__item container__item--main container__item--targets",children:[(0,n.jsx)(V,{battle:p}),(0,n.jsx)(H,{battle:p})]}),(0,n.jsx)("div",{className:"container__item container__item--aside container__item--sticky",children:p?(0,n.jsxs)("div",{className:K().halfAndHalf,"data-single":!!h.length,children:[(0,n.jsx)("div",{children:(0,n.jsx)(B,{title:"Battle Leaderboard",battleId:p.id})}),h.length?null:(0,n.jsx)("div",{children:(0,n.jsx)(J.E,{battleId:p.id})})]}):null})]}):(0,n.jsx)("div",{className:"container",children:(0,n.jsx)("div",{className:"container__item container__item--main",children:(0,n.jsx)(j.R,{children:"Fetching battle details..."})})}),(0,n.jsx)(d.$,{})]})}},4136:function(){},2259:function(e){e.exports={battleMode:"BattleModeInfoPill_battleMode___alHa",gameModeLabel:"BattleModeInfoPill_gameModeLabel__m7soO"}},3781:function(e){e.exports={halfAndHalf:"Homepage_halfAndHalf__aOimb",homepageTileContainer:"Homepage_homepageTileContainer__kHUUH",homeTile:"Homepage_homeTile__wGEl5",customBattle:"Homepage_customBattle__3KfvQ",customBattleHighlighted:"Homepage_customBattleHighlighted__q5lok",customBattle_name:"Homepage_customBattle_name__2rMne",liveCounterTile:"Homepage_liveCounterTile__pcCjZ",liveCounter:"Homepage_liveCounter__0oZ7g",liveCounterEmoji:"Homepage_liveCounterEmoji__xMfRJ",learnTile:"Homepage_learnTile__SJjw7"}},4030:function(e){e.exports={isNonCssAvailable:function({levelId:e,battleId:t}){return e?e>=141:t?t>22:void 0},NON_CSS_START_LEVEL_ID:141,normalizeDate:function(e){return"string"===typeof e?new Date(e):e.toDate?e.toDate():new Date(1e3*(e.seconds||e._seconds))}}}},function(e){e.O(0,[154,836,774,888,179],(function(){return t=9249,e(e.s=t);var t}));var t=e.O();_N_E=t}]);
//# sourceMappingURL=[battleId]-10472d9a9e993777.js.map